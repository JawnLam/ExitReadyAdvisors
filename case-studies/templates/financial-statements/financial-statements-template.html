<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adjusted Trial Balance - PDF Exporter</title>
    <!-- html2pdf.js for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- marked.js for Markdown to HTML conversion -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #2c2c2c;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .controls {
            width: 100%;
            max-width: 1200px;
            margin-bottom: 20px;
            text-align: right;
        }
        #download-pdf {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        #download-pdf:hover {
            background-color: #005a9e;
        }
        #pdf-content {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        /* Styles for the rendered markdown content */
        #rendered-markdown h1 {
            color: #2c2c2c;
            margin: 0;
            font-size: 28px;
            font-weight: 600;
            border-bottom: 3px solid #4a4a4a;
            padding-bottom: 20px;
            margin-bottom: 10px;
        }
        #rendered-markdown h2 {
            color: #666;
            margin-top: 0;
            font-size: 14px;
            font-weight: normal;
            margin-bottom: 30px;
        }
        #rendered-markdown table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        #rendered-markdown th {
            background-color: #e8e8e8;
            color: #2c2c2c;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #b0b0b0;
        }
        #rendered-markdown td {
            padding: 10px 12px;
            border-bottom: 1px solid #ddd;
        }
        #rendered-markdown td:nth-child(3),
        #rendered-markdown td:nth-child(4),
        #rendered-markdown th:nth-child(3),
        #rendered-markdown th:nth-child(4) {
            text-align: right;
            font-family: 'Courier New', monospace;
        }
        #rendered-markdown strong {
            font-weight: 600;
        }
    </style>
</head>
<body>

    <div class="controls">
        <button id="download-pdf">Download PDF</button>
    </div>

    <!-- This div contains the content that will be rendered and converted to PDF -->
    <div id="pdf-content">
        <div id="rendered-markdown"></div>
    </div>

    <!-- This hidden div holds the raw markdown content -->
    <div id="markdown-source" style="display:none;">
<!--Nothing above this should be modified by the AI or LLM. Below this point is the beginning of where the AI or LLM should populate the details of the financial statement, giving special attention to the place holders in the H1 and H2 headers below.--> 
# Adjusted Trial Balance for Johnson & Sons Heating, Plumbing, & Air
## **As of December 31, 2024**<br>

| Account # | Account Name | Debit ($) | Credit ($) |
| :--- | :--- | :--- | :--- |
| **Assets** | | | |
| 1010 | Cash and Cash Equivalents | 2,850,000 | |
| 1200 | Accounts Receivable | 11,600,000 | |
| 1300 | Inventory | 1,800,000 | |
| 1400 | Prepaid Expenses | 450,000 | |
| 1500 | Furniture, Fixtures & Equipment (Cost) | 9,200,000 | |
| 1510 | Accumulated Depreciation - FF&E | | 3,800,000 |
| 1600 | Buildings and Improvements (Cost) | 7,500,000 | |
| 1610 | Accumulated Depreciation - Buildings | | 1,300,000 |
| 1700 | Other Assets | 200,000 | |
| **Liabilities** | | | |
| 2100 | Accounts Payable | | 5,850,000 |
| 2200 | Accrued Expenses | | 1,650,000 |
| 2300 | Line of Credit | | 5,000,000 |
| 2400 | Equipment Loans | | 2,250,000 |
| 2500 | Mortgages Payable | | 2,500,000 |
| **Equity** | | | |
| 3100 | Common Stock | | 100,000 |
| 3200 | Additional Paid-in Capital | | 500,000 |
| 3300 | Retained Earnings (Beginning) | | 5,650,000 |
| **Revenues** | | | |
| 4100 | Contract Revenue - HVAC | | 41,310,000 |
| 4200 | Contract Revenue - Plumbing | | 27,540,000 |
| **Cost of Goods Sold** | | | |
| 5100 | Materials Cost | 28,228,500 | |
| 5200 | Subcontractor Costs | 16,524,000 | |
| 5300 | Direct Labor | 10,327,500 | |
| **Operating Expenses** | | | |
| 6100 | Management Salaries | 3,100,000 | |
| 6200 | Office Staff Salaries | 1,650,000 | |
| 6300 | Insurance | 1,200,000 | |
| 6400 | Depreciation Expense | 850,000 | |
| 6500 | Other SG&A Expenses | 2,260,000 | |
| **Other Expenses** | | | |
| 7100 | Interest Expense | 460,000 | |
| **TOTALS** | | **98,100,000** | **98,100,000** |

<!--This is the end of where the AI or LLM should populate the details of the financial statement. Nothing below this should be modified by the AI or LLM.-->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- 1. Render Markdown to HTML ---
            const markdownSource = document.getElementById('markdown-source').textContent;
            const renderedMarkdownContainer = document.getElementById('rendered-markdown');
            
            // Use marked.js to parse the markdown content
            renderedMarkdownContainer.innerHTML = marked.parse ? marked.parse(markdownSource) : marked(markdownSource);



            // --- 2. Setup PDF Download Button ---
            const downloadButton = document.getElementById('download-pdf');
            downloadButton.addEventListener('click', () => {
                const element = document.getElementById('pdf-content');
                
                // Get the actual content dimensions
                const contentWidth = element.scrollWidth;
                const contentHeight = element.scrollHeight;
                
                // Convert pixels to inches (assuming 96 DPI)
                const DPI = 96;
                const widthInches = (contentWidth / DPI) + 1; // Add 1 inch total margin
                const heightInches = (contentHeight / DPI) + 1; // Add 1 inch total margin
                
                // --- Generate Dynamic Filename ---
                const h1Element = document.querySelector('#rendered-markdown h1');
                let filename = 'financial-statement.pdf'; // fallback
                
                if (h1Element) {
                    const h1Text = h1Element.textContent.toLowerCase();
                    
                    // Extract statement type and business name
                    let statementType = '';
                    let businessName = 'name-of-business';
                    
                    // Split on "for" to separate statement type from business name
                    const parts = h1Text.split(' for ');
                    if (parts.length >= 2) {
                        statementType = parts[0].trim();
                        businessName = parts[1].trim();
                    } else {
                        statementType = h1Text.trim();
                    }
                    
                    // Clean up business name: first replace & with "and", then replace non-alphanumeric chars with spaces, then spaces with hyphens
                    businessName = businessName.replace(/&/g, 'and').replace(/[^a-z0-9]/g, ' ').replace(/\s+/g, '-');
                    
                    // Map statement types to numbers and clean names
                    const statementMap = {
                        'adjusted trial balance': '1-adjusted-trial-balance',
                        'income statement': '2-income-statement',
                        'statement of shareholders equity': '3-statement-of-shareholders-equity',
                        'statement of shareholder equity': '3-statement-of-shareholders-equity',
                        'shareholders equity': '3-statement-of-shareholders-equity',
                        'balance sheet': '4-balance-sheet',
                        'statement of cash flows': '5-statement-of-cash-flows',
                        'cash flow statement': '5-statement-of-cash-flows',
                        'closing disclosures': '6-closing-disclosures'
                    };
                    
                    // Find matching statement type
                    let mappedStatement = '';
                    for (const [key, value] of Object.entries(statementMap)) {
                        if (statementType.includes(key)) {
                            mappedStatement = value;
                            break;
                        }
                    }
                    
                    // Generate filename
                    if (mappedStatement) {
                        filename = `${mappedStatement}-${businessName}.pdf`;
                    } else {
                        // Fallback: create generic numbered filename
                        const cleanStatement = statementType.replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-');
                        filename = `${cleanStatement}-${businessName}.pdf`;
                    }
                }
                
                // --- Configuration for html2pdf.js with dynamic page size ---
                const opt = {
                    margin:       [0.25, 0.25, 0.25, 0.25], // top, left, bottom, right in inches
                    filename:     filename,
                    image:        { type: 'jpeg', quality: 0.98 },
                    html2canvas:  { scale: 2, useCORS: true }, // Higher scale for better quality
                    jsPDF:        { 
                        unit: 'in', 
                        format: [widthInches, heightInches], // Custom format based on content size
                        orientation: widthInches > heightInches ? 'landscape' : 'portrait'
                    }
                };

                // --- Generate and save the PDF ---
                html2pdf().set(opt).from(element).save();
            });
        });
    </script>

</body>
</html>