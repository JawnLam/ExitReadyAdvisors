<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Balance Sheet</title>
    
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- html2pdf.js for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- marked.js for Markdown to HTML conversion -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>

    <style>
        /* Custom styles for printing and fine-tuning */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print {
                display: none;
            }
        }
        /* Ensure table content doesn't break weirdly in the PDF */
        table {
            page-break-inside: auto;
        }
        tr {
            page-break-inside: avoid;
            page-break-after: auto;
        }
        thead {
            display: table-header-group;
        }
        tbody {
            display: table-row-group;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans p-4 sm:p-8 flex flex-col items-center">
    <!-- Controls section with the download button -->
<!--
    <div class="controls w-full max-w-7xl mb-6 flex justify-end no-print">
        <button id="download-pdf" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 ease-in-out flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
            <span>Download PDF</span>
        </button>
    </div>
-->

    <!-- This div contains the content that will be rendered and converted to PDF -->
    <div id="pdf-content" class="w-full max-w-7xl bg-white p-6 sm:p-10 rounded-xl shadow-lg">
        <div id="rendered-markdown"></div>
    </div>

    <!-- This hidden div holds the raw markdown content -->
    <div id="markdown-source" style="display:none;">
<!--Nothing above this should be modified by the AI or LLM. Below this point is the beginning of where the AI or LLM should populate the details of the financial statement, giving special attention to the place holders in the H1 and H2 headers below.-->
# Balance Sheet for Johnson & Sons Heating, Plumbing, & Air
## **As of December 31, 2024**<br>

### Assets
| Acct # | Account Name | 2024 Amount ($) | % | 2023 Amount ($) | Change ($) |
| :--- | :--- | ---: | :--- | ---: | ---: |
| **Current Assets** | | | | | |
| *Cash and Cash Management* | | | | | |
| 1010 | Cash and Cash Equivalents | $2,850,000 | 10.0% | $2,450,000 | $400,000 |
| ● 1011 | Operating Accounts - Unrestricted | $1,850,000 | 6.5% | $1,650,000 | $200,000 |
| ● ● | Wells Fargo - Phoenix Operations | $925,000 | 3.2% | | |
| ● ● | Zions Bank - Salt Lake Operations | $555,000 | 1.9% | | |
| ● ● | FirstBank - Denver Operations | $370,000 | 1.3% | | |
| ● 1012 | Payroll Accounts | $650,000 | 2.3% | $550,000 | $100,000 |
| ● 1013 | Restricted Cash - Project Escrows | $350,000 | 1.2% | $250,000 | $100,000 |
| *Contract Assets and Receivables* | | | | | |
| 1200 | Accounts Receivable - Trade | $11,600,000 | 40.7% | $10,850,000 | $750,000 |
| ● 1210 | Progress Billings Receivable | $7,540,000 | 26.5% | $7,050,000 | $490,000 |
| ● ● 1211 | Current (0-30 days) | $4,524,000 | 15.9% | | |
| ● ● 1212 | 31-60 days | $2,262,000 | 7.9% | | |
| ● ● 1213 | 61-90 days | $603,200 | 2.1% | | |
| ● ● 1214 | Over 90 days | $150,800 | 0.5% | | |
| ● 1220 | Retainage Receivable | $2,320,000 | 8.1% | $2,175,000 | $145,000 |
| ● ● 1221 | Expected within 12 months | $1,624,000 | 5.7% | | |
| ● ● 1222 | Expected 12-24 months | $696,000 | 2.4% | | |
| ● 1230 | Completed Contract Receivables | $928,000 | 3.3% | $868,000 | $60,000 |
| ● 1240 | Change Order Receivables | $580,000 | 2.0% | $435,000 | $145,000 |
| ● 1245 | Back-charge Receivables | $232,000 | 0.8% | $217,500 | $14,500 |
| ● 1250 | Less: Allowance for Doubtful Accounts | ($140,000) | -0.5% | ($130,400) | ($9,600) |
| 1260 | Contract Assets (Unbilled Revenue/WIP) | $4,440,000 | 15.6% | $3,960,000 | $480,000 |
| ● 1261 | Costs in Excess of Billings | $2,220,000 | 7.8% | | |
| ● 1262 | Estimated Earnings on Uncompleted Contracts | $1,776,000 | 6.2% | | |
| ● 1263 | Materials Stored for Future Use | $444,000 | 1.6% | | |
| *Inventory and Supplies* | | | | | |
| 1300 | Inventory | $1,800,000 | 6.3% | $1,650,000 | $150,000 |
| ● 1310 | HVAC Equipment Inventory | $720,000 | 2.5% | $660,000 | $60,000 |
| ● ● | Trane Equipment | $288,000 | 1.0% | | |
| ● ● | Carrier Equipment | $216,000 | 0.8% | | |
| ● ● | Other HVAC Brands | $216,000 | 0.8% | | |
| ● 1320 | Plumbing Materials | $540,000 | 1.9% | $495,000 | $45,000 |
| ● 1330 | Sheet Metal & Ductwork | $216,000 | 0.8% | $198,000 | $18,000 |
| ● 1340 | Controls & Automation Components | $144,000 | 0.5% | $132,000 | $12,000 |
| ● 1350 | Consumables & Small Tools | $108,000 | 0.4% | $99,000 | $9,000 |
| ● 1360 | PPE & Safety Equipment | $72,000 | 0.3% | $66,000 | $6,000 |
| *Prepaid Expenses and Other Current Assets* | | | | | |
| 1400 | Prepaid Expenses | $450,000 | 1.6% | $425,000 | $25,000 |
| ● 1410 | Prepaid Insurance | $180,000 | 0.6% | $170,000 | $10,000 |
| ● ● | General Liability | $72,000 | 0.3% | | |
| ● ● | Workers Compensation | $54,000 | 0.2% | | |
| ● ● | Other Insurance | $54,000 | 0.2% | | |
| ● 1420 | Prepaid Licenses & Bonds | $135,000 | 0.5% | $127,500 | $7,500 |
| ● 1430 | Prepaid Software & Technology | $54,000 | 0.2% | $51,000 | $3,000 |
| ● 1440 | Prepaid Rent & Leases | $45,000 | 0.2% | $42,500 | $2,500 |
| ● 1450 | Other Prepaid Expenses | $36,000 | 0.1% | $34,000 | $2,000 |
| 1500 | Other Current Assets | $660,000 | 2.3% | $550,000 | $110,000 |
| ● 1510 | Supplier Rebates Receivable | $330,000 | 1.2% | $275,000 | $55,000 |
| ● 1520 | Employee Advances | $132,000 | 0.5% | $110,000 | $22,000 |
| ● 1530 | Income Tax Refunds Receivable | $99,000 | 0.3% | $82,500 | $16,500 |
| ● 1540 | Other Receivables | $99,000 | 0.3% | $82,500 | $16,500 |
| **Total Current Assets** || **$21,800,000** | **76.5%** | **$20,285,000** | **$1,515,000** |
| | | | | | |
| **Property, Plant and Equipment** | | | | | |
| *Real Property* | | | | | |
| 1600 | Land | $1,500,000 | 5.3% | $1,500,000 | $- |
| ● 1601 | Phoenix Land (5 acres) | $800,000 | 2.8% | | |
| ● 1602 | Salt Lake City Land (3 acres) | $400,000 | 1.4% | | |
| ● 1603 | Denver Land (2 acres) | $300,000 | 1.1% | | |
| 1610 | Buildings and Improvements | $6,000,000 | 21.1% | $6,000,000 | $- |
| ● 1611 | Phoenix Facility (40,000 sq ft) | $3,200,000 | 11.2% | | |
| ● 1612 | Salt Lake City Facility (20,000 sq ft) | $1,600,000 | 5.6% | | |
| ● 1613 | Denver Facility (15,000 sq ft) | $1,200,000 | 4.2% | | |
| ● 1620 | Less: Accumulated Depreciation - Buildings | ($1,300,000) | -4.6% | ($1,050,000) | ($250,000) |
| ● | Net Buildings and Land | $6,200,000 | 21.8% | $6,450,000 | ($250,000) |
| *Equipment and Vehicles* | | | | | |
| 1700 | Fleet Vehicles | $4,250,000 | 14.9% | $3,900,000 | $350,000 |
| ● 1710 | Service Trucks (65 units) | $2,925,000 | 10.3% | | |
| ● 1720 | Vans (15 units) | $525,000 | 1.8% | | |
| ● 1730 | Management Vehicles (5 units) | $250,000 | 0.9% | | |
| ● 1740 | Heavy Trucks & Trailers | $550,000 | 1.9% | | |
| 1800 | Construction Equipment | $2,300,000 | 8.1% | $2,150,000 | $150,000 |
| ● 1810 | Fabrication Equipment | $920,000 | 3.2% | | |
| ● 1820 | Lifting Equipment (Cranes, Hoists) | $690,000 | 2.4% | | |
| ● 1830 | Welding & Cutting Equipment | $460,000 | 1.6% | | |
| ● 1840 | Testing & Diagnostic Equipment | $230,000 | 0.8% | | |
| 1900 | Shop Tools and Equipment | $1,150,000 | 4.0% | $1,100,000 | $50,000 |
| 2000 | Office Equipment and Technology | $1,500,000 | 5.3% | $1,500,000 | $- |
| ● 2010 | Computer Hardware | $450,000 | 1.6% | | |
| ● 2020 | Software Licenses (Capitalized) | $600,000 | 2.1% | | |
| ● 2030 | Office Furniture & Fixtures | $300,000 | 1.1% | | |
| ● 2040 | Communication Equipment | $150,000 | 0.5% | | |
| ● 2100 | Less: Accumulated Depreciation - Equipment | ($3,800,000) | -13.3% | ($3,200,000) | ($600,000) |
| ● | Net Equipment and Vehicles | $5,400,000 | 18.9% | $5,450,000 | ($50,000) |
| **Total Property, Plant and Equipment (Net)** || **$11,600,000** | **40.7%** | **$11,900,000** | **($300,000)** |
| | | | | | |
| **Intangible Assets** | | | | | |
| 2200 | Customer Relationships | $2,200,000 | 7.7% | $2,200,000 | $- |
| ● 2210 | Less: Accumulated Amortization | ($1,100,000) | -3.9% | ($880,000) | ($220,000) |
| ● | Net Customer Relationships | $1,100,000 | 3.9% | $1,320,000 | ($220,000) |
| 2300 | Trade Name and Trademarks | $880,000 | 3.1% | $880,000 | $- |
| ● 2310 | Less: Accumulated Amortization | ($440,000) | -1.5% | ($352,000) | ($88,000) |
| ● | Net Trade Name | $440,000 | 1.5% | $528,000 | ($88,000) |
| 2400 | Non-Compete Agreements | $300,000 | 1.1% | $300,000 | $- |
| ● 2410 | Less: Accumulated Amortization | ($240,000) | -0.8% | ($180,000) | ($60,000) |
| ● | Net Non-Compete Agreements | $60,000 | 0.2% | $120,000 | ($60,000) |
| **Total Intangible Assets (Net)** || **$1,600,000** | **5.6%** | **$1,968,000** | **($368,000)** |
| | | | | | |
| **Other Long-Term Assets** | | | | | |
| 2500 | Deferred Tax Assets (State NOLs) | $165,000 | 0.6% | $150,000 | $15,000 |
| 2600 | Security Deposits and Bonds | $132,000 | 0.5% | $120,000 | $12,000 |
| ● 2610 | Utility Deposits | $66,000 | 0.2% | | |
| ● 2620 | License Bonds | $66,000 | 0.2% | | |
| 2700 | Life Insurance Cash Surrender Value | $88,000 | 0.3% | $80,000 | $8,000 |
| 2800 | Other Assets | $115,000 | 0.4% | $102,000 | $13,000 |
| **Total Other Long-Term Assets** || **$500,000** | **1.8%** | **$452,000** | **$48,000** |
| | | | | | |
| **TOTAL ASSETS** || **$35,500,000** | **124.6%** | **$34,605,000** | **$895,000** |

### Liabilities and Shareholders' Equity
| Acct # | Account Name | 2024 Amount ($) | % | 2023 Amount ($) | Change ($) |
| :--- | :--- | ---: | :--- | ---: | ---: |
| **Current Liabilities** | | | | | |
| *Trade and Operating Payables* | | | | | |
| 3100 | Accounts Payable - Trade | $5,850,000 | 16.5% | $5,425,000 | $425,000 |
| ● 3110 | Material Suppliers | $2,925,000 | 8.2% | $2,712,500 | $212,500 |
| ● ● | HVAC Equipment Suppliers | $1,755,000 | 4.9% | | |
| ● ● | Plumbing Suppliers | $877,500 | 2.5% | | |
| ● ● | Other Material Suppliers | $292,500 | 0.8% | | |
| ● 3120 | Subcontractor Payables | $1,755,000 | 4.9% | $1,627,500 | $127,500 |
| ● ● | Controls & Automation Subs | $702,000 | 2.0% | | |
| ● ● | Insulation & Sheet Metal Subs | $526,500 | 1.5% | | |
| ● ● | Other Specialty Subs | $526,500 | 1.5% | | |
| ● 3130 | Operating Expense Payables | $877,500 | 2.5% | $813,750 | $63,750 |
| ● 3140 | Retainage Payable | $292,500 | 0.8% | $271,250 | $21,250 |
| *Accrued Liabilities* | | | | | |
| 3200 | Accrued Expenses | $1,650,000 | 4.6% | $1,525,000 | $125,000 |
| ● 3210 | Accrued Payroll | $495,000 | 1.4% | $457,500 | $37,500 |
| ● 3220 | Accrued Union Benefits | $247,500 | 0.7% | $228,750 | $18,750 |
| ● 3230 | Accrued Bonuses | $297,000 | 0.8% | $274,500 | $22,500 |
| ● 3240 | Accrued Vacation/PTO | $214,500 | 0.6% | $198,375 | $16,125 |
| ● 3250 | Accrued Interest | $115,000 | 0.3% | $106,250 | $8,750 |
| ● 3260 | Accrued Workers Compensation | $99,000 | 0.3% | $91,125 | $7,875 |
| ● 3270 | Other Accrued Expenses | $182,000 | 0.5% | $168,500 | $13,500 |
| *Tax Liabilities* | | | | | |
| 3300 | Sales Tax Payable | $344,250 | 1.0% | $326,000 | $18,250 |
| ● 3310 | Arizona Sales Tax | $172,125 | 0.5% | | |
| ● 3320 | Utah Sales Tax | $103,275 | 0.3% | | |
| ● 3330 | Colorado Sales Tax | $68,850 | 0.2% | | |
| 3400 | Payroll Tax Liabilities | $275,400 | 0.8% | $260,800 | $14,600 |
| *Contract Liabilities* | | | | | |
| 3500 | Contract Liabilities (Billings in Excess of Costs) | $4,400,000 | 12.4% | $3,960,000 | $440,000 |
| ● 3510 | Customer Deposits | $1,320,000 | 3.7% | $1,188,000 | $132,000 |
| ● 3520 | Advance Billings on Contracts | $2,200,000 | 6.2% | $1,980,000 | $220,000 |
| ● 3530 | Deferred Revenue - Service Contracts | $880,000 | 2.5% | $792,000 | $88,000 |
| *Short-Term Debt* | | | | | |
| 3600 | Line of Credit - Wells Fargo | $5,000,000 | 14.1% | $4,500,000 | $500,000 |
| 3700 | Current Portion of Long-Term Debt | $825,000 | 2.3% | $775,000 | $50,000 |
| ● 3710 | Current Portion - Equipment Loans | $525,000 | 1.5% | | |
| ● 3720 | Current Portion - Mortgages | $300,000 | 0.8% | | |
| 3800 | Other Current Liabilities | $280,350 | 0.8% | $227,800 | $52,550 |
| **Total Current Liabilities** || **$18,825,000** | **53.0%** | **$17,299,600** | **$1,525,400** |
| | | | | | |
| **Long-Term Liabilities** | | | | | |
| 4000 | Equipment Loans (Net of Current Portion) | $1,725,000 | 4.9% | $1,825,000 | ($100,000) |
| ● 4010 | Vehicle Financing | $1,035,000 | 2.9% | | |
| ● 4020 | Equipment Financing | $690,000 | 1.9% | | |
| 4100 | Mortgages Payable (Net of Current Portion) | $2,200,000 | 6.2% | $2,400,000 | ($200,000) |
| ● 4110 | Phoenix Facility Mortgage | $1,100,000 | 3.1% | | |
| ● 4120 | Salt Lake City Facility Mortgage | $660,000 | 1.9% | | |
| ● 4130 | Denver Facility Mortgage | $440,000 | 1.2% | | |
| 4200 | Deferred Compensation Obligations | $550,000 | 1.5% | $500,000 | $50,000 |
| 4300 | Self-Insurance Reserves | $385,000 | 1.1% | $350,000 | $35,000 |
| 4400 | Warranty Liabilities | $413,100 | 1.2% | $391,200 | $21,900 |
| 4500 | Other Long-Term Liabilities | $236,900 | 0.7% | $239,200 | ($2,300) |
| **Total Long-Term Liabilities** || **$5,510,000** | **15.5%** | **$5,705,400** | **($195,400)** |
| | | | | | |
| **TOTAL LIABILITIES** || **$24,335,000** | **68.6%** | **$23,005,000** | **$1,330,000** |
| | | | | | |
| **Shareholders' Equity** | | | | | |
| 5000 | Common Stock ($1 par value) | $100,000 | 0.3% | $100,000 | $- |
| ● | Authorized: 500,000 shares | | | | |
| ● | Issued and Outstanding: 100,000 shares | | | | |
| 5100 | Additional Paid-In Capital | $500,000 | 1.4% | $500,000 | $- |
| 5200 | Retained Earnings | $10,565,000 | 29.8% | $11,000,000 | ($435,000) |
| 5300 | Accumulated Other Comprehensive Income | $- | 0.0% | $- | $- |
| **TOTAL SHAREHOLDERS' EQUITY** || **$11,165,000** | **31.4%** | **$11,600,000** | **($435,000)** |
| | | | | | |
| **TOTAL LIABILITIES AND SHAREHOLDERS' EQUITY** || **$35,500,000** | **100.0%** | **$34,605,000** | **$895,000** |


<!--This is the end of where the AI or LLM should populate the details of the financial statement. Nothing below this should be modified by the AI or LLM.-->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- 1. Render Markdown to HTML ---
            const markdownSource = document.getElementById('markdown-source').textContent;
            const renderedMarkdownContainer = document.getElementById('rendered-markdown');
            
            // Use marked.js to parse the markdown content
            renderedMarkdownContainer.innerHTML = marked.parse ? marked.parse(markdownSource) : marked(markdownSource);

            // --- 2. Apply Tailwind CSS classes to the generated content ---
            function applyStyling() {
                const container = document.getElementById('rendered-markdown');
                if (!container) return;

                // Style Headers
                // REMOVED text-center to make headers left-aligned
                container.querySelectorAll('h1').forEach(el => el.classList.add('text-3xl', 'sm:text-4xl', 'font-bold', 'text-gray-900', 'pb-4', 'mb-2', 'border-b-2', 'border-gray-200'));
                container.querySelectorAll('h2').forEach(el => {
                    // REMOVED text-center to make headers left-aligned and simplified logic
                    el.classList.add('text-lg', 'font-normal', 'text-gray-500', 'mt-0', 'mb-8');
                });
                container.querySelectorAll('h3').forEach(el => el.classList.add('text-xl', 'font-semibold', 'text-gray-700', 'mt-8', 'mb-4'));

                // Style Tables
                container.querySelectorAll('table').forEach(table => {
                    // ADDED font-mono to make the entire table monospaced
                    table.classList.add('min-w-full', 'divide-y', 'divide-gray-300', 'mt-6', 'mb-8', 'border', 'border-gray-200', 'rounded-lg', 'shadow-sm', 'overflow-hidden', 'font-mono');
                    const thead = table.querySelector('thead');
                    if (thead) {
                        thead.classList.add('bg-gray-50');
                    }
                    table.querySelectorAll('th').forEach(th => {
                        // ADDED whitespace-nowrap to prevent headers from wrapping
                        th.classList.add('px-4', 'py-3', 'sm:px-6', 'sm:py-3.5', 'text-left', 'text-sm', 'font-semibold', 'text-gray-900', 'whitespace-nowrap');
                    });
                    table.querySelectorAll('tbody tr:nth-child(odd)').forEach(row => {
                        row.classList.add('bg-white'); // Use white for odd rows
                    });
                     table.querySelectorAll('tbody tr:nth-child(even)').forEach(row => {
                        row.classList.add('bg-gray-50'); // Use light gray for even rows for zebra striping
                    });
                    table.querySelectorAll('td').forEach(td => {
                        td.classList.add('px-4', 'py-3', 'sm:px-6', 'sm:py-4', 'text-sm', 'text-gray-600');
                        // Make bold text inside tables stand out more
                        td.querySelectorAll('strong').forEach(strong => strong.classList.add('font-bold', 'text-gray-800'));
                    });
                    
                    // Right-align numeric-heavy columns
                    table.querySelectorAll('tr').forEach(row => {
                        // Target all but the first two columns for right alignment
                        row.querySelectorAll('td:not(:nth-child(1)):not(:nth-child(2)), th:not(:nth-child(1)):not(:nth-child(2))').forEach(cell => {
                            cell.classList.add('text-right');
                        });
                    });
                });

                // Style Paragraphs, Lists, and other elements
                container.querySelectorAll('p').forEach(el => el.classList.add('mb-4', 'leading-relaxed', 'text-gray-700'));
                container.querySelectorAll('ul').forEach(el => el.classList.add('list-disc', 'list-inside', 'mb-4', 'pl-4', 'text-gray-700', 'space-y-2'));
                container.querySelectorAll('strong').forEach(el => el.classList.add('font-semibold', 'text-gray-800'));
                container.querySelectorAll('hr').forEach(el => el.classList.add('my-10', 'border-t', 'border-gray-200'));
            }
            
            applyStyling();

            // --- 3. Setup PDF Download Button ---
            // NOTE: Download button is commented out in the HTML, but the logic remains.
            const downloadButton = document.getElementById('download-pdf');
            if (downloadButton) { // FIXED: Check if button exists before adding listener
                downloadButton.addEventListener('click', () => {
                    const element = document.getElementById('pdf-content');
                    
                    // --- Generate Dynamic Filename ---
                    const h1Element = document.querySelector('#rendered-markdown h1');
                    let filename = 'financial-statement.pdf'; // fallback
                    
                    if (h1Element) {
                        const h1Text = h1Element.textContent.toLowerCase();
                        let statementType = '';
                        let businessName = 'name-of-business';
                        const parts = h1Text.split(' for ');
                        if (parts.length >= 2) {
                            statementType = parts[0].trim();
                            businessName = parts[1].trim();
                        } else {
                            statementType = h1Text.trim();
                        }
                        businessName = businessName.replace(/&/g, 'and').replace(/[^a-z0-9]/g, ' ').replace(/\s+/g, '-');
                        const statementMap = {
                            'adjusted trial balance': '1-adjusted-trial-balance',
                            'income statement': '2-income-statement',
                            'statement of shareholders equity': '3-statement-of-shareholders-equity',
                            'statement of shareholder equity': '3-statement-of-shareholders-equity',
                            'shareholders equity': '3-statement-of-shareholders-equity',
                            'balance sheet': '4-balance-sheet',
                            'statement of cash flows': '5-statement-of-cash-flows',
                            'cash flow statement': '5-statement-of-cash-flows',
                            'closing disclosures': '6-closing-disclosures'
                        };
                        let mappedStatement = '';
                        for (const [key, value] of Object.entries(statementMap)) {
                            if (statementType.includes(key)) {
                                mappedStatement = value;
                                break;
                            }
                        }
                        if (mappedStatement) {
                            filename = `${mappedStatement}-${businessName}.pdf`;
                        } else {
                            const cleanStatement = statementType.replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-');
                            filename = `${cleanStatement}-${businessName}.pdf`;
                        }
                    }
                    
                    // --- Configuration for html2pdf.js ---
                    const opt = {
                        margin:       [0.5, 0.25, 0.5, 0.25], // top, left, bottom, right in inches
                        filename:     filename,
                        image:        { type: 'jpeg', quality: 0.98 },
                        html2canvas:  { scale: 2, useCORS: true, letterRendering: true },
                        jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
                    };

                    // --- Generate and save the PDF ---
                    html2pdf().set(opt).from(element).save();
                });
            }
        });
    </script>

</body>
</html>
